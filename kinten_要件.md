# 📌 Kinten（勤転） 実装要件ドキュメント

## 📝 概要
**Kinten（勤転）**は、freee等の勤怠CSVを読み込み、指定のExcel勤怠表テンプレートへ自動転記し出力する**ローカル専用**のデスクトップアプリです。GUIはモダンかつ親しみやすい**ニューモフィズムスタイル**を採用し、**Windows / macOS 両対応**を目指します。

---

## 🔧 技術スタック

### フロントエンド（GUI）
- **Flutter**
  - Windows/macOSデスクトップアプリ対応
  - ニューモフィズム風デザイン
  - ローカルファイル選択・パス指定機能
  - プログレス表示、完了通知、エラーダイアログ

### バックエンド
- **Python**
  - CSV整形（freee勤怠CSV → DataFrame）
  - Excel転記処理（`openpyxl`）
  - Flutterとは`subprocess`/FFI/HTTP(localhost)経由で接続

### パッケージ
- openpyxl（Excel編集）
- pandas（CSV整形）
- re, os（ファイル名解析）

---

## 📂 入力ファイル仕様

### 勤怠CSV（freeeエクスポート）
- ファイル名形式：`勤怠詳細_山田太郎_2025_07.csv`
- 日付、始業時刻、終業時刻、勤怠種別、総勤務時間 等の列を含む

### Excelテンプレート
- ファイル名：`勤怠表_ひな型.xlsx`
- 初期シート名：「勤務表」
- 書式：A列 日付, C列 始業, D列 終業, E列 休憩, F列 総勤務時間
- G6セルに従業員名、F5/H5に年月、シート名も年月に応じて変更（例：`勤怠表_202507`）

---

## 🖱️ ユーザー操作フロー

1. アプリ起動
2. CSVファイル選択
3. テンプレートExcel選択
4. 出力先フォルダ/ファイル名を選択
5. 「変換して保存」ボタンを押下
6. 成功通知 or エラー表示

---

## 🖼️ UIデザイン方針

- ニューモフィズム（soft UI）
- カラーパレット：
  - 背景：#F2F3F5（オフホワイト）
  - アクセント：#5A6B8C（グレイッシュブルー）
- アイコン：独自ロゴ「勤転」＋時計＋表アイコン（生成済）
- コンポーネント：
  - ファイルパス選択用ボタン/テキストボックス
  - 実行ボタン
  - ステータス表示
  - 軽量なステート管理（例：Riverpod）

---

## 📤 出力ファイル
- `勤怠表_山田太郎_2025_07.xlsx`
- 指定フォルダに保存（上書き確認あり）

---

## ⚙️ バックエンド実装（概要）

```python
def write_to_excel(template_path, output_path, df, csv_filename):
    wb = openpyxl.load_workbook(template_path)
    sheet = wb["勤務表"]
    # シート名変更など処理
    # G6: 氏名 / H5: 月 / F5: 年
    # A11〜 転記
    wb.save(output_path)
