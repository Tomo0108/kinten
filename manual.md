### Kinten ユーザー向け導入マニュアル（macOS / Windows）

Kinten（勤転）は、freee 等の勤怠CSVをExcelの勤怠表テンプレートへ自動転記し、PDF出力にも対応するデスクトップアプリです。処理はすべてローカルで完結します。

- 対応OS
  - macOS 12 以降
  - Windows 10 / 11
- PDF変換の要件
  - Windows: Microsoft Excel（デスクトップ版）が必須
  - macOS: Microsoft Excel を推奨（自動化許可が必要）。Excel 非導入の場合は簡易PDFにフォールバック

---

## macOS 版

### 1. ダウンロード
- 配布ページ（リリースページや社内配布サイト）から「macOS 版」をダウンロードします。
  - 配布物の名称例: `kinten.zip`
- ダウンロード後、ZIP を展開してフォルダ `kinten/` を取得します。

### 2. 配布物のディレクトリ構造
ZIP を展開すると、次のような構成になります。

```
kinten/
  ├─ kinten.app
  ├─ kinten_backend                # バックエンド（同梱の実行バイナリ）
  ├─ backend/                      # バックエンドのPythonソース（フォールバック用）
  ├─ templates/                    # 勤怠表テンプレート
  ├─ input/                        # CSV配置先（必要に応じてサンプルが入ることがあります）
  ├─ output/                       # 出力先（初回は空）
  └─ requirements.txt              # 依存関係（フォールバック実行時の参考）
```

- 通常は `kinten.app` を起動するだけで利用できます。
- PDF変換は、Microsoft Excel がインストールされている場合に Excel を優先して使用します（許可が必要）。
- Excel がない場合は「簡易PDF」にフォールバックします（レイアウト再現度は限定的）。

### 3. 初回起動とセキュリティ許可
- Gatekeeper によりブロックされた場合は、「右クリック → 開く」から起動してください。
- 初回起動時、Excel 自動化の許可ダイアログが表示される場合があります。
  - 表示例: 「“kinten.app” が “Microsoft Excel” を操作しようとしています」
  - その場合は「OK（許可）」を選択してください。
  - 後から変更する場合: システム設定 → プライバシーとセキュリティ → 自動化 で `kinten.app → Microsoft Excel` を許可

### 4. 使い方（CSV → Excel）
- `kinten.app` を起動
- 画面の案内に沿って以下を設定
  - CSVファイル: `input/` に置いた勤怠CSVを選択
  - テンプレート: 既定で `templates/勤怠表雛形_2025年版.xlsx` が自動選択されます（必要に応じて変更可）
  - 従業員名: 出力ファイル名等に使用
- 変換を実行すると、`output/` に Excel が出力されます（処理完了後、出力フォルダが自動で開きます）

### 5. 使い方（Excel → PDF）
- アプリ内の PDF 変換セクションで、PDF化したい Excel ファイル（複数可）を選択
- 変換を実行
  - Excel が導入されていれば Excel 経由で高品質PDFを生成
  - 未導入の場合は簡易PDF（制約あり）で出力
- 出力先は `output/`（完了後に自動で開きます）

### 6. 更新・アンインストール
- 更新: 新しい ZIP をダウンロードして展開し、既存の `kinten/` を置き換えます（`templates/` を差し替えたい場合はバックアップ推奨）
- アンインストール: `kinten/` フォルダを削除するだけで完了
- 設定は標準のアプリ設定領域に保存されます。再設定が必要な場合はアプリ内の設定リセットをご利用ください

### 7. ログとトラブルシュート
- ログ
  - アプリ汎用ログ: `~/Library/Logs/kinten.log`
  - 画面操作ログ（フロント一部）: `kinten/output/logs/frontend.log`
- よくある事象
  - 「開発元を確認できないため開けません」 → 右クリック → 開く
  - Excel の操作許可ダイアログが出ない/失敗する → システム設定 → プライバシーとセキュリティ → 自動化 で許可を確認
  - 出力フォルダが開かない → `kinten/output/` を手動で確認

---

## Windows 版

### 1. ダウンロード
- 配布ページ（リリースページや社内配布サイト）から「Windows 版」をダウンロードします。
  - 配布物の名称例: `kinten_windows_<version>.zip`
- ダウンロード後、ZIP を展開してフォルダ `kinten/` を取得します。
- SmartScreen が表示された場合は「詳細情報」→「実行」を選択してください（社内配布物として正規）。

### 2. 配布物のディレクトリ構造
ZIP を展開すると、次のような構成になります。

```
kinten/
  ├─ kinten.exe                 # アプリ本体（ダブルクリックで起動）
  ├─ kinten_backend.exe         # バックエンド（Python不要の同梱実行ファイル）
  ├─ backend/                   # バックエンドのPythonソース（フォールバック用）
  ├─ templates/                 # 勤怠表テンプレート
  ├─ input/                     # CSV配置先（空で配布）
  ├─ output/                    # 出力先（初回は空）
  ├─ requirements.txt
  ├─ VERSION.txt                # ビルド時刻等
  ├─ data/
  │   ├─ flutter_assets/        # Flutter リソース
  │   └─ icudtl.dat
  ├─ flutter_windows.dll（または flutter.dll）
  └─ （各種プラグインDLL 例: permission_handler_windows_plugin.dll など）
```

- アプリはポータブルです。任意の場所（例: `C:\Users\<you>\Apps\kinten\`）に置いて利用できます。
- `kinten_backend.exe` が同階層に存在することを前提に動作します（移動/削除しないでください）。

### 3. 初回起動と要件
- `kinten.exe` をダブルクリックで起動します。
- PDF 変換を行う場合は Microsoft Excel（デスクトップ版）が必要です。未導入の場合、PDF変換はエラーになります（CSV→Excel 変換は可能）。
- SmartScreen が警告する場合は「詳細情報」→「実行」を選択してください。

### 4. 使い方（CSV → Excel）
- 画面の案内に沿って以下を設定
  - CSVファイル: `input/` に置いた勤怠CSVを選択
  - テンプレート: 既定で `templates/勤怠表雛形_2025年版.xlsx` が自動選択されます（必要に応じて変更可）
  - 従業員名: 出力ファイル名等に使用
- 変換を実行すると、`output/` に Excel が出力されます（処理完了後、出力フォルダが自動で開きます）

### 5. 使い方（Excel → PDF）
- PDF変換セクションで、PDF化したい Excel ファイル（複数可）を選択
- 変換を実行
  - Microsoft Excel が導入済みであれば Excel 経由で高品質PDFを生成
  - Excel が未導入の場合はエラーとなります（macOS のような簡易フォールバックは無し）
- 出力先は `output/`（完了後に自動で開きます）

### 6. 更新・アンインストール
- 更新: 新しい ZIP をダウンロードして展開し、既存の `kinten/` を置き換えます
- アンインストール: `kinten/` フォルダを削除するだけで完了
- 設定はアプリ内部に保存されます。再設定が必要な場合はアプリ内でリセットを行ってください

### 7. ログとトラブルシュート
- ログ
  - 画面操作ログ（フロント一部）: `kinten/output/logs/frontend.log`
- よくある事象
  - PDF変換で「Excelがインストールされていません」 → Microsoft Excel をインストール
  - 出力フォルダが開かない → `kinten/output/` を手動で確認
  - `kinten_backend.exe` を削除/移動してしまった → ZIP を再展開して `kinten.exe` と同階層に復元

---

## 操作のポイントとベストプラクティス

- CSVファイル名例: 「勤怠詳細_氏名_YYYY_MM.csv」など、対象月が分かる命名を推奨
- テンプレートは `templates/勤怠表雛形_2025年版.xlsx` を標準で同梱。改版時は差し替え可能（バックアップ推奨）
- 出力は基本的に `kinten/output/` に生成されます（完了後、自動でフォルダを開きます）
- データはすべてローカル処理。社外秘データの取り扱いに配慮してください

---

## よくある質問（FAQ）

- Q. テンプレートを自社用に修正して使えますか？
  - A. 可能です。`templates/` 内のファイルを差し替えてから、アプリ内のテンプレートパスで選択してください。
- Q. 別PCにコピーして使えますか？
  - A. 可能です。ZIP を展開した `kinten/` フォルダ一式をコピーしてください。
- Q. 出力先を変更できますか？
  - A. 可能です。アプリ内で出力先を設定し、以後はそのパスが優先されます。

---

以上で導入から基本操作まで完了です。ご不明点があれば配布ページの連絡先へお問い合わせください。


