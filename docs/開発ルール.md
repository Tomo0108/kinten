# 開発ルール

## ディレクトリ構造管理

### 基本ルール
1. **重複フォルダの禁止**: 同じ名前のフォルダが複数の場所に存在してはいけない
2. **階層追加時の記録**: 新しいディレクトリ構造を追加する際は、必ずこのファイルに記載する
3. **構造変更の記録**: ディレクトリ構造を変更した場合は、このファイルを更新する

### 現在のディレクトリ構造
```
kinten/
├── .git/
├── .history/
├── assets/
├── backend/
│   ├── __init__.py
│   ├── create_sample_template.py
│   ├── csv_processor.py
│   ├── excel_processor.py
│   ├── main_processor.py
│   ├── main.py
│   └── pdf_converter.py
├── build/
├── dist/                   # Flutterアプリの配布用ビルド成果物（正しい場所）
├── docs/                   # ドキュメント類の整理された場所
│   ├── README.md
│   ├── タスクリスト.md
│   ├── kinten_要件.md
│   ├── デザイン要件.md
│   ├── PDF変換機能修正タスクリスト.md
│   └── 開発ルール.md
├── frontend/
│   ├── assets/
│   ├── build/              # Flutter開発用ビルド成果物
│   ├── lib/
│   ├── test/
│   ├── windows/
│   ├── .dart_tool/
│   ├── .idea/
│   ├── analysis_options.yaml
│   ├── pubspec.yaml
│   └── README.md
├── input/
├── output/
│   └── 2025_06/
├── templates/
├── venv/
├── .gitignore
├── check_environment.ps1
├── kinten_backend.spec
├── pyrightconfig.json
├── requirements.txt
└── README.md
```

### 削除済みの重複フォルダ
- ✅ `dist/` (ルートディレクトリ) - 削除完了
- ✅ `frontend/dist_new/` - 削除完了
- ✅ `frontend/dist/` - ルートディレクトリに移動完了

### 作業履歴
- 2025-01-XX: 重複フォルダの削除とルールファイル作成
  - ルートディレクトリの `dist/` フォルダを削除
  - `frontend/dist_new/` フォルダを削除
  - `frontend/dist/` フォルダを正しい場所として維持
- 2025-01-XX: ディレクトリ構造の正規化とドキュメント整理
  - `frontend/dist/` をルートディレクトリの `dist/` に移動（配布用ビルド成果物の正しい場所）
  - 散らばっていたmdファイルを `docs/` ディレクトリに整理
  - 開発ルールファイルを `docs/` に移動
- 2025-01-XX: PDF変換機能のUIデザイン統一
  - PDF変換ウィジェットのヘッダーデザインを他のUIと統一
  - セクションヘッダーのデザインを統一（アイコン付きグラデーション背景）
  - フォルダ選択ウィジェットをNeumorphicContainerに統一
  - 全体的なデザインの一貫性を向上
- 2025-01-XX: ファイル一覧表示機能の修正
  - Flutterアプリのパス解決ロジックを修正（frontendディレクトリ構造に対応）
  - Pythonバックエンド呼び出し時の環境変数を改善（PATH追加）
  - Pythonスクリプトにデバッグ情報を追加してエラー特定を容易化
  - 仮想環境のPythonパスを正しく設定
- 2025-01-XX: 実行ボタンの独立化
  - 自動転記機能とPDF変換機能のステータス管理を完全に分離
  - 各機能に独立したステータス（autoTransferStatus, pdfConversionStatus）を実装
  - ボタンの状態管理を独立化して機能間の干渉を防止
  - ステータス表示セクションも機能別に分離
  - 後方互換性のためのメソッドを残しつつ、新しい独立したメソッドを追加
 - 2025-01-XX: 自動転記処理の修正
   - CSVプロセッサーの列名検証を柔軟化（異なるCSV形式に対応）
   - 列名の統一化機能を追加（出勤時刻→始業時刻1、退勤時刻→終業時刻1等）
   - 日付形式の対応を拡張（YYYY-MM-DD形式に対応）
   - テスト用CSVファイルを作成して動作確認
   - 自動転記処理が正常に動作することを確認
 - 2025-01-XX: タブ切り替え時のボタン表示修正
   - TabControllerにリスナーを追加してタブ切り替え時のUI更新を確実化
   - TabBarViewにキーを追加してタブ切り替え時の強制再構築を実装
   - デバッグログを追加してタブ切り替えの動作を詳細に追跡
   - タブに応じたボタン表示の確実性を向上
 - 2025-01-XX: 転記処理エラーのデバッグ強化
   - Pythonバックエンドの直接テストで正常動作を確認
   - Flutterアプリからの呼び出し時のデバッグログを強化
   - ファイル存在チェックの詳細ログを追加
   - テンプレートパスとCSVパスの詳細情報を出力
 - 2025-01-XX: 転記処理エラーの根本原因調査
   - Pythonバックエンドの段階的テスト（CSV、Excel、統合処理）
   - FlutterアプリのPythonプロセス実行結果の詳細ログ追加
   - _handlePythonResultメソッドのデバッグ情報強化
   - エラーハンドリングの改善と詳細なログ出力

## コミットメッセージルール
- コミットメッセージは一行で簡潔に記述する

## 言語ルール
- 常に日本語で応答する

## 問題発生時の対応
- 指摘された問題や問題行動は、このルールファイルに追記して次回に活かす
- ルール違反が発生した場合は、即座にこのファイルを更新する 